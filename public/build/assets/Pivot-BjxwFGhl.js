import{r as P,c as S,a as d,b as n,h as A,i as B,w as r,e,q as y,t as l,v as k,o as u,F as x,j as g,G as F,A as C,I as T,n as j,B as I}from"./app-DLRClR93.js";import{A as z}from"./AuthenticatedLayout-X2c9acdw.js";import{_ as f}from"./Card.vue_vue_type_script_setup_true_lang-BPYeHnK8.js";import{_}from"./Button.vue_vue_type_script_setup_true_lang-BEwuWev6.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"space-y-6"},H={class:"flex items-center justify-between"},N={class:"flex items-center space-x-4"},R={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},Y={class:"bg-surface-2 rounded-lg p-4"},K={class:"text-xl font-bold text-primary"},W={class:"bg-surface-2 rounded-lg p-4"},q={class:"text-xl font-bold text-success"},G={class:"bg-surface-2 rounded-lg p-4"},J={class:"text-xl font-bold text-warning"},Q={class:"bg-surface-2 rounded-lg p-4"},X={class:"text-xl font-bold text-danger"},Z={class:"bg-surface-2 rounded-lg p-4"},tt={class:"text-xl font-bold text-info"},et={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},st=["value"],ot={class:"flex items-end space-x-2"},at={class:"flex items-end space-x-2"},lt={class:"flex flex-wrap gap-4"},nt={class:"text-sm text-text-3"},rt={class:"flex items-center justify-between mb-6"},it={class:"text-lg font-semibold text-text"},dt={class:"text-sm text-muted"},ut={class:"overflow-x-auto"},ct={class:"min-w-full divide-y divide-border"},ft={class:"bg-surface-2 sticky top-0"},mt={class:"text-xs text-muted"},xt={class:"bg-surface-1 divide-y divide-border"},vt={class:"px-4 py-3 sticky left-0 bg-surface-1 hover:bg-surface-2 z-10"},gt={class:"text-sm font-medium text-text"},_t={class:"text-xs text-text-3"},pt=["title"],bt={key:1,class:"w-8 h-8 mx-auto rounded bg-gray-100 flex items-center justify-center text-xs text-gray-400"},yt={__name:"Pivot",props:{pivotData:Object,statusConfig:Object,outlets:Array,filters:Object},setup(c){const m=c,a=P({outlet_id:m.filters.outlet_id||"",date_from:m.filters.date_from||"",date_to:m.filters.date_to||""}),w=o=>{const t=a.value.date_from?new Date(a.value.date_from):new Date,s=new Date(t);o==="prev"?s.setMonth(s.getMonth()-1):s.setMonth(s.getMonth()+1);const i=new Date(s.getFullYear(),s.getMonth(),1),p=new Date(s.getFullYear(),s.getMonth()+1,0);a.value.date_from=i.toISOString().split("T")[0],a.value.date_to=p.toISOString().split("T")[0],b()},b=()=>{I.get(route("reports.pivot"),{...a.value},{preserveState:!0,preserveScroll:!0})},M=()=>{a.value={outlet_id:"",date_from:"",date_to:""},b()},$=()=>{const o=new URLSearchParams;Object.keys(a.value).forEach(t=>{a.value[t]&&o.append(t,a.value[t])}),window.location.href=route("reports.export.pivot")+"?"+o.toString()},L=S(()=>a.value.date_from?new Date(a.value.date_from).toLocaleDateString("id-ID",{year:"numeric",month:"long"}):""),v=S(()=>{const o=m.pivotData.summary.attendance_summary,t=Object.values(o).reduce((s,i)=>s+i,0);return{total:t,...o,attendance_rate:t>0?((o.on_time+o.late+o.early_checkout+o.overtime)/t*100).toFixed(1):0}}),O=o=>new Date(o).toLocaleDateString("id-ID",{day:"numeric",month:"short"}),h=o=>{const t=new Date(o);return t.getDay()===0||t.getDay()===6},D=o=>{const t=m.statusConfig[o]||m.statusConfig.absent;return{backgroundColor:t.bg_color,color:t.color}},V=o=>{if(!o)return"Tidak ada data";let s=`${(m.statusConfig[o.status]||{text:"Unknown"}).text}`;return o.check_in_time&&(s+=`
Check-in: ${o.check_in_time}`),o.check_out_time&&(s+=`
Check-out: ${o.check_out_time}`),o.work_duration&&o.work_duration!=="Still checked in"&&(s+=`
Durasi: ${o.work_duration}`),o.late_minutes>0&&(s+=`
Terlambat: ${o.late_minutes} menit`),o.early_checkout_minutes>0&&(s+=`
Pulang awal: ${o.early_checkout_minutes} menit`),o.overtime_minutes>0&&(s+=`
Lembur: ${o.overtime_minutes} menit`),s};return(o,t)=>(u(),d(x,null,[n(A(B),{title:"Pivot Table Laporan Absensi"}),n(z,null,{default:r(()=>[e("div",E,[e("div",H,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-2xl font-bold text-text",style:{"font-family":"'Oswald', sans-serif"}}," Pivot Table Absensi "),e("p",{class:"text-muted"}," Laporan absensi detail per karyawan ")],-1)),e("div",N,[n(_,{onClick:$,variant:"primary"},{default:r(()=>[...t[5]||(t[5]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),y(" Export CSV ",-1)])]),_:1})])]),e("div",R,[n(f,null,{default:r(()=>[e("div",Y,[e("div",K,l(v.value.total),1),t[7]||(t[7]=e("div",{class:"text-sm text-muted"},"Total Record",-1))])]),_:1}),n(f,null,{default:r(()=>[e("div",W,[e("div",q,l(v.value.on_time),1),t[8]||(t[8]=e("div",{class:"text-sm text-muted"},"Hadir Tepat Waktu",-1))])]),_:1}),n(f,null,{default:r(()=>[e("div",G,[e("div",J,l(v.value.late),1),t[9]||(t[9]=e("div",{class:"text-sm text-muted"},"Terlambat",-1))])]),_:1}),n(f,null,{default:r(()=>[e("div",Q,[e("div",X,l(v.value.absent),1),t[10]||(t[10]=e("div",{class:"text-sm text-muted"},"Tidak Hadir",-1))])]),_:1}),n(f,null,{default:r(()=>[e("div",Z,[e("div",tt,l(v.value.attendance_rate)+"% ",1),t[11]||(t[11]=e("div",{class:"text-sm text-muted"},"Tingkat Kehadiran",-1))])]),_:1})]),n(f,null,{default:r(()=>[e("div",et,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-text-3 text-sm font-medium mb-2"},"Outlet",-1)),k(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.outlet_id=s),class:"w-full px-3 py-2 bg-surface-1 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary"},[t[12]||(t[12]=e("option",{value:""},"Semua Outlet",-1)),(u(!0),d(x,null,g(c.outlets,s=>(u(),d("option",{key:s.id,value:s.id},l(s.name),9,st))),128))],512),[[F,a.value.outlet_id]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-text-3 text-sm font-medium mb-2"},"Dari Tanggal",-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.date_from=s),type:"date",class:"w-full px-3 py-2 bg-surface-1 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[C,a.value.date_from]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-text-3 text-sm font-medium mb-2"},"Sampai Tanggal",-1)),k(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.date_to=s),type:"date",class:"w-full px-3 py-2 bg-surface-1 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary"},null,512),[[C,a.value.date_to]])]),e("div",ot,[n(_,{onClick:b,variant:"primary"},{default:r(()=>[...t[16]||(t[16]=[y("Terapkan",-1)])]),_:1}),n(_,{onClick:M,variant:"secondary"},{default:r(()=>[...t[17]||(t[17]=[y("Reset",-1)])]),_:1})]),e("div",at,[n(_,{onClick:t[3]||(t[3]=s=>w("prev")),variant:"secondary"},{default:r(()=>[...t[18]||(t[18]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),n(_,{onClick:t[4]||(t[4]=s=>w("next")),variant:"secondary"},{default:r(()=>[...t[19]||(t[19]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),_:1})])])]),_:1}),n(f,null,{default:r(()=>[t[20]||(t[20]=e("h3",{class:"text-lg font-semibold text-text mb-4"}," Legenda Status ",-1)),e("div",lt,[(u(!0),d(x,null,g(c.statusConfig,(s,i)=>(u(),d("div",{key:i,class:"flex items-center space-x-2"},[e("div",{class:"w-4 h-4 rounded flex items-center justify-center text-xs font-bold",style:T(D(i))},l(s.icon),5),e("span",nt,l(s.text),1)]))),128))])]),_:1}),n(f,null,{default:r(()=>[e("div",rt,[e("h3",it," Pivot Table - "+l(L.value),1),e("div",dt,l(c.pivotData.summary.total_employees)+" karyawan â€¢ "+l(c.pivotData.date_range.total_days)+" hari ",1)]),e("div",ut,[e("table",ct,[e("thead",ft,[e("tr",null,[t[21]||(t[21]=e("th",{class:"px-4 py-3 text-left text-xs font-medium text-text-3 uppercase tracking-wider sticky left-0 bg-surface-2 z-10"}," Karyawan ",-1)),(u(!0),d(x,null,g(c.pivotData.date_range.dates,s=>(u(),d("th",{key:s,class:j(["px-2 py-3 text-center text-xs font-medium text-text-3 uppercase tracking-wider min-w-[60px]",{"bg-gray-100":h(s)}])},[e("div",null,l(O(s)),1),e("div",mt,l(new Date(s).toLocaleDateString("id-ID",{weekday:"short"})),1)],2))),128))])]),e("tbody",xt,[(u(!0),d(x,null,g(c.pivotData.employees,s=>(u(),d("tr",{key:s.id,class:"hover:bg-surface-2"},[e("td",vt,[e("div",null,[e("div",gt,l(s.name),1),e("div",_t,l(s.outlet||"-"),1)])]),(u(!0),d(x,null,g(c.pivotData.date_range.dates,i=>{var p;return u(),d("td",{key:i,class:j(["px-2 py-2 text-center",{"bg-gray-50":h(i)}])},[s.attendances[i]?(u(),d("div",{key:0,class:"w-8 h-8 mx-auto rounded flex items-center justify-center text-xs font-bold cursor-pointer hover:scale-110 transition-transform",style:T(D(s.attendances[i].status)),title:V(s.attendances[i])},l(((p=c.statusConfig[s.attendances[i].status])==null?void 0:p.icon)||"?"),13,pt)):(u(),d("div",bt," - "))],2)}),128))]))),128))])])])]),_:1})])]),_:1})],64))}},Ct=U(yt,[["__scopeId","data-v-fb483ee5"]]);export{Ct as default};
