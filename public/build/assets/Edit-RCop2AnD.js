import{m as P,r as V,f as $,a as l,b,h as o,i as F,w as c,e as t,d as u,t as i,l as C,q as T,o as a,p as R,v as m,A as p,x as O,F as S,j as W,n as G,G as J}from"./app-Bi7HOOmg.js";import{A as K}from"./AuthenticatedLayout-CosheEKI.js";import{_ as A}from"./Card.vue_vue_type_script_setup_true_lang-Bwwk7C6e.js";import{_ as h}from"./Button.vue_vue_type_script_setup_true_lang-CLgP9_cW.js";import{B as H}from"./Breadcrumb-WjWOs7bQ.js";import{L as g}from"./leaflet-src-D1c7kP4r.js";/* empty css                */import{m as Z,a as Q,b as X}from"./marker-shadow-C3VGSqE1.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"space-y-6"},te={class:"flex items-center justify-between"},re={class:"text-muted"},oe={key:0,class:"bg-green-900/20 border border-green-600 rounded-lg p-4"},se={class:"flex"},le={class:"text-green-400"},ae={key:1,class:"bg-red-900/20 border border-red-600 rounded-lg p-4"},ne={class:"flex"},ie={class:"text-red-400"},de={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ue={key:0,class:"mt-1 text-sm text-error"},me={key:0,class:"mt-1 text-sm text-error"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},be={key:0,class:"mt-1 text-sm text-error"},ce={class:"flex items-end"},xe={class:"inline-flex items-center"},fe={class:"mb-4"},ge={key:0,class:"flex items-center"},ke={key:1,class:"flex items-center"},ye={key:0,class:"mb-4 p-3 bg-error-100 border border-error rounded-lg text-error text-sm"},ve={class:"grid grid-cols-2 gap-4"},_e={key:0,class:"mt-1 text-sm text-error"},we={key:0,class:"mt-1 text-sm text-error"},he={key:0,class:"mt-1 text-sm text-error"},Me={class:"border-t border-border pt-6"},Ue={class:"space-y-4"},Te={class:"grid grid-cols-2 gap-4"},Ie={key:0,class:"mt-1 text-sm text-error"},Le={key:0,class:"mt-1 text-sm text-error"},Ve={class:"grid grid-cols-4 gap-2"},Ce=["value"],Oe={class:"text-sm text-text-2"},Se={key:0,class:"mt-1 text-sm text-error"},Ae={key:0,class:"mt-1 text-sm text-error"},je={class:"border-t border-border pt-6"},Ee={class:"grid grid-cols-2 gap-4"},qe={key:0,class:"mt-1 text-sm text-error"},ze={key:0,class:"mt-1 text-sm text-error"},Be={key:0,class:"mt-1 text-sm text-error"},De={key:0,class:"mt-1 text-sm text-error"},Ne={class:"flex items-center justify-end space-x-4"},Pe={key:0},$e={key:1},Fe={__name:"Edit",props:{outlet:Object},setup(v){delete g.Icon.Default.prototype._getIconUrl,g.Icon.Default.mergeOptions({iconRetinaUrl:X,iconUrl:Q,shadowUrl:Z});const d=v,I=n=>{if(!n)return null;const e=String(n).match(/(\d{2}:\d{2})/);return e?e[1]:null},r=P({name:d.outlet.name,address:d.outlet.address,latitude:d.outlet.latitude,longitude:d.outlet.longitude,radius:d.outlet.radius,default_salary:d.outlet.default_salary||"",use_tax:d.outlet.use_tax??!0,operational_start_time:d.outlet.operational_start_time_formatted??I(d.outlet.operational_start_time)??"08:00",operational_end_time:d.outlet.operational_end_time_formatted??I(d.outlet.operational_end_time)??"17:00",work_days:d.outlet.work_days||[1,2,3,4,5],timezone:d.outlet.timezone||"Asia/Jakarta",late_tolerance_minutes:d.outlet.late_tolerance_minutes??15,early_checkout_tolerance:d.outlet.early_checkout_tolerance??10,grace_period_minutes:d.outlet.grace_period_minutes??5,overtime_threshold_minutes:d.outlet.overtime_threshold_minutes??60});let f=null,_=null,w=null;const k=V(!1),x=V(""),j=async()=>{if(!navigator.geolocation){x.value="Browser tidak mendukung geolocation";return}k.value=!0,x.value="",navigator.geolocation.getCurrentPosition(E,q,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},E=n=>{const{latitude:e,longitude:y}=n.coords;r.latitude=e.toFixed(6),r.longitude=y.toFixed(6),U(),f&&f.setView([e,y],15),k.value=!1,x.value=""},q=n=>{switch(k.value=!1,n.code){case n.PERMISSION_DENIED:x.value="Akses lokasi ditolak. Silakan aktifkan permission lokasi.";break;case n.POSITION_UNAVAILABLE:x.value="Informasi lokasi tidak tersedia.";break;case n.TIMEOUT:x.value="Timeout mendapatkan lokasi. Coba lagi.";break;default:x.value="Terjadi kesalahan mendapatkan lokasi."}},z=()=>{f=g.map("map").setView([r.latitude,r.longitude],15),g.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:19}).addTo(f),_=g.marker([r.latitude,r.longitude],{draggable:!0}).addTo(f),w=g.circle([r.latitude,r.longitude],{color:"#fb923c",fillColor:"#fb923c",fillOpacity:.2,radius:r.radius}).addTo(f),_.on("dragend",function(n){const e=n.target.getLatLng();r.latitude=e.lat.toFixed(6),r.longitude=e.lng.toFixed(6),M()})},M=()=>{w&&(w.setRadius(r.radius),w.setLatLng([r.latitude,r.longitude]))},U=()=>{_&&(_.setLatLng([r.latitude,r.longitude]),M())},B=()=>{r.put(route("outlets.update",d.outlet.id),{onSuccess:()=>{window.handleSuccess(`Outlet ${r.name} berhasil diperbarui.`)},onError:n=>{window.handleError(n)}})};$(()=>{setTimeout(()=>{z()},100)});const D=[{name:"Dashboard",href:route("dashboard")},{name:"Manajemen Outlet",href:route("outlets.index")},{name:"Edit Outlet"}];return(n,e)=>(a(),l(S,null,[b(o(F),{title:`Edit ${v.outlet.name}`},null,8,["title"]),b(K,null,{breadcrumb:c(()=>[b(H,{items:D})]),default:c(()=>{var y,L;return[t("div",ee,[t("div",te,[t("div",null,[e[15]||(e[15]=t("h1",{class:"text-2xl font-bold text-text",style:{"font-family":"'Oswald', sans-serif"}}," Edit Outlet ",-1)),t("p",re," Perbarui informasi outlet "+i(v.outlet.name),1)]),b(o(C),{href:n.route("outlets.index")},{default:c(()=>[b(h,{variant:"secondary"},{default:c(()=>[...e[16]||(e[16]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),T(" Kembali ke Daftar ",-1)])]),_:1})]),_:1},8,["href"])]),(y=n.$page.props.flash)!=null&&y.success?(a(),l("div",oe,[t("div",se,[e[17]||(e[17]=t("svg",{class:"w-5 h-5 text-green-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("div",le,i(n.$page.props.flash.success),1)])])):u("",!0),(L=n.$page.props.flash)!=null&&L.error?(a(),l("div",ae,[t("div",ne,[e[18]||(e[18]=t("svg",{class:"w-5 h-5 text-red-400 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("div",ie,i(n.$page.props.flash.error),1)])])):u("",!0),t("div",de,[b(A,null,{default:c(()=>[e[45]||(e[45]=t("h2",{class:"text-xl font-semibold text-text mb-6",style:{"font-family":"'Oswald', sans-serif"}}," Informasi Outlet ",-1)),t("form",{onSubmit:R(B,["prevent"]),class:"space-y-6"},[t("div",null,[e[19]||(e[19]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Nama Outlet ",-1)),m(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o(r).name=s),type:"text",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Masukkan nama outlet",required:""},null,512),[[p,o(r).name]]),o(r).errors.name?(a(),l("div",ue,i(o(r).errors.name),1)):u("",!0)]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Alamat ",-1)),m(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=s=>o(r).address=s),rows:"3",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Masukkan alamat outlet",required:""},null,512),[[p,o(r).address]]),o(r).errors.address?(a(),l("div",me,i(o(r).errors.address),1)):u("",!0)]),t("div",pe,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Default Gaji Pokok (per bulan) ",-1)),m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o(r).default_salary=s),type:"number",min:"0",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Contoh: 2000000"},null,512),[[p,o(r).default_salary,void 0,{number:!0}]]),o(r).errors.default_salary?(a(),l("div",be,i(o(r).errors.default_salary),1)):u("",!0),e[22]||(e[22]=t("p",{class:"text-xs text-muted mt-1"}," Dipakai jika karyawan tidak memiliki base salary. ",-1))]),t("div",ce,[t("label",xe,[m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o(r).use_tax=s),type:"checkbox",class:"mr-2"},null,512),[[O,o(r).use_tax]]),e[23]||(e[23]=t("span",{class:"text-sm text-text"},"Terapkan pajak 5% pada payroll",-1))])])]),t("div",fe,[b(h,{type:"button",onClick:j,disabled:k.value,variant:"secondary",class:"w-full"},{default:c(()=>[k.value?(a(),l("span",ge,[...e[24]||(e[24]=[t("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),T(" Mendapatkan lokasi... ",-1)])])):(a(),l("span",ke," ðŸ“ Gunakan Lokasi Saat Ini "))]),_:1},8,["disabled"])]),x.value?(a(),l("div",ye,i(x.value),1)):u("",!0),t("div",ve,[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Latitude ",-1)),m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o(r).latitude=s),type:"number",step:"0.000001",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"-6.200000",onInput:U,required:""},null,544),[[p,o(r).latitude]]),o(r).errors.latitude?(a(),l("div",_e,i(o(r).errors.latitude),1)):u("",!0)]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Longitude ",-1)),m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o(r).longitude=s),type:"number",step:"0.000001",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"106.816666",onInput:U,required:""},null,544),[[p,o(r).longitude]]),o(r).errors.longitude?(a(),l("div",we,i(o(r).errors.longitude),1)):u("",!0)])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Radius Geofence (meter) ",-1)),m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o(r).radius=s),type:"number",min:"10",max:"1000",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"50",onInput:M,required:""},null,544),[[p,o(r).radius]]),o(r).errors.radius?(a(),l("div",he,i(o(r).errors.radius),1)):u("",!0),e[28]||(e[28]=t("p",{class:"mt-1 text-sm text-muted"}," Karyawan harus berada dalam radius ini untuk melakukan check-in. ",-1))]),t("div",Me,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold text-text mb-4",style:{"font-family":"'Oswald', sans-serif"}}," Jam Operasional ",-1)),t("div",Ue,[t("div",Te,[t("div",null,[e[29]||(e[29]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Waktu Mulai ",-1)),m(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>o(r).operational_start_time=s),type:"time",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",required:""},null,512),[[p,o(r).operational_start_time]]),o(r).errors.operational_start_time?(a(),l("div",Ie,i(o(r).errors.operational_start_time),1)):u("",!0)]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Waktu Selesai ",-1)),m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>o(r).operational_end_time=s),type:"time",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",required:""},null,512),[[p,o(r).operational_end_time]]),o(r).errors.operational_end_time?(a(),l("div",Le,i(o(r).errors.operational_end_time),1)):u("",!0)])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Hari Kerja ",-1)),t("div",Ve,[(a(),l(S,null,W([{value:1,label:"Sen"},{value:2,label:"Sel"},{value:3,label:"Rab"},{value:4,label:"Kam"},{value:5,label:"Jum"},{value:6,label:"Sab"},{value:7,label:"Min"}],s=>t("label",{key:s.value,class:G(["flex items-center space-x-2 p-2 rounded border border-border cursor-pointer hover:bg-surface-3",{"bg-primary border-primary":o(r).work_days.includes(s.value)}])},[m(t("input",{type:"checkbox",value:s.value,"onUpdate:modelValue":e[9]||(e[9]=N=>o(r).work_days=N),class:"rounded text-primary focus:ring-primary bg-surface-2 border-border"},null,8,Ce),[[O,o(r).work_days]]),t("span",Oe,i(s.label),1)],2)),64))]),o(r).errors.work_days?(a(),l("div",Se,i(o(r).errors.work_days),1)):u("",!0)]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Timezone ",-1)),m(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>o(r).timezone=s),class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",required:""},[...e[32]||(e[32]=[t("option",{value:"Asia/Jakarta"}," WIB (UTC+7) ",-1),t("option",{value:"Asia/Makassar"}," WITA (UTC+8) ",-1),t("option",{value:"Asia/Jayapura"}," WIT (UTC+9) ",-1)])],512),[[J,o(r).timezone]]),o(r).errors.timezone?(a(),l("div",Ae,i(o(r).errors.timezone),1)):u("",!0)])])]),t("div",je,[e[43]||(e[43]=t("h3",{class:"text-lg font-semibold text-text mb-4",style:{"font-family":"'Oswald', sans-serif"}}," Pengaturan Toleransi ",-1)),t("div",Ee,[t("div",null,[e[35]||(e[35]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Grace Period (menit) ",-1)),m(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o(r).grace_period_minutes=s),type:"number",min:"0",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",required:""},null,512),[[p,o(r).grace_period_minutes]]),o(r).errors.grace_period_minutes?(a(),l("div",qe,i(o(r).errors.grace_period_minutes),1)):u("",!0),e[36]||(e[36]=t("p",{class:"mt-1 text-xs text-muted"}," Waktu tambahan sebelum dianggap terlambat ",-1))]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Toleransi Keterlambatan (menit) ",-1)),m(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>o(r).late_tolerance_minutes=s),type:"number",min:"0",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",required:""},null,512),[[p,o(r).late_tolerance_minutes]]),o(r).errors.late_tolerance_minutes?(a(),l("div",ze,i(o(r).errors.late_tolerance_minutes),1)):u("",!0),e[38]||(e[38]=t("p",{class:"mt-1 text-xs text-muted"}," Maksimal keterlambatan yang diperbolehkan ",-1))]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Toleransi Checkout Awal (menit) ",-1)),m(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>o(r).early_checkout_tolerance=s),type:"number",min:"0",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",required:""},null,512),[[p,o(r).early_checkout_tolerance]]),o(r).errors.early_checkout_tolerance?(a(),l("div",Be,i(o(r).errors.early_checkout_tolerance),1)):u("",!0),e[40]||(e[40]=t("p",{class:"mt-1 text-xs text-muted"}," Maksimal checkout lebih awal yang diperbolehkan ",-1))]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-text-2 text-sm font-medium mb-2"}," Threshold Lembur (menit) ",-1)),m(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>o(r).overtime_threshold_minutes=s),type:"number",min:"0",class:"w-full px-3 py-2 bg-surface-2 border border-border text-text rounded-none focus:outline-none focus:ring-2 focus:ring-primary",required:""},null,512),[[p,o(r).overtime_threshold_minutes]]),o(r).errors.overtime_threshold_minutes?(a(),l("div",De,i(o(r).errors.overtime_threshold_minutes),1)):u("",!0),e[42]||(e[42]=t("p",{class:"mt-1 text-xs text-muted"}," Minimal jam kerja untuk dihitung lembur ",-1))])])]),t("div",Ne,[b(o(C),{href:n.route("outlets.show",v.outlet.id)},{default:c(()=>[b(h,{variant:"secondary",type:"button"},{default:c(()=>[...e[44]||(e[44]=[T(" Batal ",-1)])]),_:1})]),_:1},8,["href"]),b(h,{type:"submit",disabled:o(r).processing,variant:"primary"},{default:c(()=>[o(r).processing?(a(),l("span",Pe,"Memperbarui...")):(a(),l("span",$e,"Update Outlet"))]),_:1},8,["disabled"])])],32)]),_:1}),b(A,null,{default:c(()=>[...e[46]||(e[46]=[t("h2",{class:"text-xl font-semibold text-text mb-6",style:{"font-family":"'Oswald', sans-serif"}}," Peta Lokasi ",-1),t("div",{class:"text-sm text-muted mb-4"}," Seret marker untuk menentukan lokasi tepat. Lingkaran oranye menunjukkan radius geofence. ",-1),t("div",{id:"map",class:"h-96 bg-surface-2 rounded-none border border-border"},null,-1)])]),_:1})])])]}),_:1})],64))}},Ye=Y(Fe,[["__scopeId","data-v-ffe3b491"]]);export{Ye as default};
