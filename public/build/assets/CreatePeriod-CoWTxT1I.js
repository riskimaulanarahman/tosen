import{r as j,c as S,m as U,a,b as i,h as l,i as O,w as u,e,q as m,d as h,v as p,A as x,t as n,o,F as y,j as g,G as L,n as $}from"./app-B9127wO6.js";import{A as G}from"./AuthenticatedLayout-BhaAR9wv.js";import{_ as k}from"./Card.vue_vue_type_script_setup_true_lang-Yr55VJw9.js";import{_ as v}from"./Button.vue_vue_type_script_setup_true_lang-B_FY260r.js";import{B as K}from"./Breadcrumb-uliv-1Bc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"space-y-6"},I={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},T={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},z={class:"p-5 space-y-4"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},H={class:"flex items-center justify-between text-sm"},q={class:"text-muted"},R={key:0,class:"text-xs text-danger"},J={class:"p-5 space-y-4"},Q={class:"space-y-3"},W=["value"],X={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Y={class:"flex items-center justify-between text-sm"},Z={class:"text-muted"},ee={key:0,class:"text-xs text-danger"},te={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},se={class:"p-5 space-y-4"},le={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3"},re={class:"flex flex-col sm:flex-row gap-2"},ae=["value"],oe={class:"overflow-x-auto"},de={class:"min-w-full divide-y divide-border text-sm"},ne={class:"divide-y divide-border"},ie={key:0,class:"text-center text-muted"},ue={class:"px-4 py-3"},pe={class:"space-y-1"},ce={class:"flex items-center text-xs text-muted"},me=["checked","onChange"],xe={class:"flex items-center text-xs text-muted"},be=["checked","onChange"],ye={class:"px-4 py-3"},fe={class:"font-semibold text-text"},ge={class:"text-xs text-muted"},_e={class:"px-4 py-3"},ve={class:"p-5 space-y-4"},we={class:"space-y-3"},he={class:"font-semibold"},ke={class:"text-xs text-muted"},Pe={key:0,class:"text-sm text-muted text-center"},Ue={__name:"CreatePeriod",props:{employees:{type:Array,default:()=>[]},outlets:{type:Array,default:()=>[]},payrollPeriods:{type:Array,default:()=>[]}},setup(w){const C=w,F=[{name:"Dashboard",href:route("dashboard")},{name:"Manajemen Penggajian",href:route("payroll.index")},{name:"Buat Payroll"}],f=j(""),_=j(""),V=S(()=>C.employees.filter(c=>{const t=!_.value||Number(c.outlet_id)===Number(_.value),s=!f.value||c.name.toLowerCase().includes(f.value.toLowerCase())||(c.email||"").toLowerCase().includes(f.value.toLowerCase());return t&&s})),r=U({name:"",start_date:"",end_date:"",basic_rate:5e6,overtime_rate:1.5,notes:"",user_ids:[]}),d=U({payroll_period_id:"",start_date:"",end_date:"",user_ids:[]}),D=(c,t="create")=>{const s=t==="create"?r:d;s.user_ids.includes(c)?s.user_ids=s.user_ids.filter(b=>b!==c):s.user_ids=[...s.user_ids,c]},N=()=>{r.post(route("payroll.create.period"),{preserveScroll:!0,onSuccess:()=>{r.reset(),_.value="",f.value=""}})},A=()=>{d.post(route("payroll.generate"),{preserveScroll:!0,onSuccess:()=>d.reset()})},B=S(()=>C.payrollPeriods.slice(0,5));return(c,t)=>(o(),a(y,null,[i(l(O),{title:"Buat Payroll"}),i(G,null,{breadcrumb:u(()=>[i(K,{items:F})]),default:u(()=>[e("div",M,[e("div",I,[t[14]||(t[14]=e("div",null,[e("h1",{class:"text-3xl font-bold text-text"}," Pengaturan Periode Payroll "),e("p",{class:"text-muted"}," Buat periode baru, pilih karyawan, dan jalankan proses payroll terjadwal. ")],-1)),i(v,{variant:"secondary",href:c.route("payroll.index")},{default:u(()=>[...t[13]||(t[13]=[m(" Kembali ke daftar ",-1)])]),_:1},8,["href"])]),e("div",T,[i(k,null,{default:u(()=>[e("div",z,[t[17]||(t[17]=e("h2",{class:"text-lg font-semibold text-text"}," Buat Periode Payroll ",-1)),e("div",E,[p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l(r).name=s),type:"text",placeholder:"Nama periode",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},null,512),[[x,l(r).name]]),p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l(r).basic_rate=s),type:"number",min:"0",placeholder:"Basic rate",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},null,512),[[x,l(r).basic_rate]]),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>l(r).start_date=s),type:"date",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},null,512),[[x,l(r).start_date]]),p(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l(r).end_date=s),type:"date",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},null,512),[[x,l(r).end_date]]),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l(r).overtime_rate=s),type:"number",min:"1",step:"0.1",placeholder:"Overtime multiplier",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},null,512),[[x,l(r).overtime_rate]]),p(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>l(r).notes=s),rows:"2",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg col-span-1 md:col-span-2",placeholder:"Catatan tambahan"},null,512),[[x,l(r).notes]])]),e("div",H,[e("p",q,[t[15]||(t[15]=m(" Karyawan dipilih: ",-1)),e("strong",null,n(l(r).user_ids.length),1)]),i(v,{size:"sm",variant:"ghost",onClick:t[6]||(t[6]=s=>l(r).user_ids=[])},{default:u(()=>[...t[16]||(t[16]=[m(" Hapus pilihan ",-1)])]),_:1})]),i(v,{class:"w-full",disabled:l(r).processing,onClick:N},{default:u(()=>[m(n(l(r).processing?"Menyimpan...":"Buat Periode"),1)]),_:1},8,["disabled"]),Object.keys(l(r).errors).length?(o(),a("div",R,[(o(!0),a(y,null,g(l(r).errors,(s,b)=>(o(),a("div",{key:b},n(s),1))),128))])):h("",!0)])]),_:1}),i(k,null,{default:u(()=>[e("div",J,[t[21]||(t[21]=e("h2",{class:"text-lg font-semibold text-text"}," Generate Payroll ",-1)),e("div",Q,[p(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>l(d).payroll_period_id=s),class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},[t[18]||(t[18]=e("option",{value:""},"Pilih Periode",-1)),(o(!0),a(y,null,g(w.payrollPeriods,s=>(o(),a("option",{key:s.id,value:s.id},n(s.name)+" Â· "+n(new Date(s.start_date).toLocaleDateString("id-ID")),9,W))),128))],512),[[L,l(d).payroll_period_id]]),e("div",X,[p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>l(d).start_date=s),type:"date",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},null,512),[[x,l(d).start_date]]),p(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>l(d).end_date=s),type:"date",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},null,512),[[x,l(d).end_date]])]),e("div",Y,[e("p",Z,[t[19]||(t[19]=m(" Karyawan dipilih: ",-1)),e("strong",null,n(l(d).user_ids.length),1)]),i(v,{size:"sm",variant:"ghost",onClick:t[10]||(t[10]=s=>l(d).user_ids=[])},{default:u(()=>[...t[20]||(t[20]=[m(" Hapus pilihan ",-1)])]),_:1})]),i(v,{class:"w-full",disabled:l(d).processing,onClick:A},{default:u(()=>[m(n(l(d).processing?"Memproses...":"Generate Payroll"),1)]),_:1},8,["disabled"])]),Object.keys(l(d).errors).length?(o(),a("div",ee,[(o(!0),a(y,null,g(l(d).errors,(s,b)=>(o(),a("div",{key:b},n(s),1))),128))])):h("",!0)])]),_:1})]),e("div",te,[i(k,{class:"lg:col-span-2"},{default:u(()=>[e("div",se,[e("div",le,[t[23]||(t[23]=e("div",null,[e("h2",{class:"text-lg font-semibold text-text"}," Pilih Karyawan "),e("p",{class:"text-sm text-muted"}," Filter berdasarkan outlet atau nama. ")],-1)),e("div",re,[p(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>f.value=s),type:"text",placeholder:"Cari nama/email",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},null,512),[[x,f.value]]),p(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>_.value=s),class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg"},[t[22]||(t[22]=e("option",{value:""},"Semua Outlet",-1)),(o(!0),a(y,null,g(w.outlets,s=>(o(),a("option",{key:s.id,value:s.id},n(s.name),9,ae))),128))],512),[[L,_.value]])])]),e("div",oe,[e("table",de,[t[27]||(t[27]=e("thead",null,[e("tr",{class:"text-left text-xs uppercase text-muted"},[e("th",{class:"px-4 py-3"},"Pilih"),e("th",{class:"px-4 py-3"},"Karyawan"),e("th",{class:"px-4 py-3"},"Outlet")])],-1)),e("tbody",ne,[V.value.length===0?(o(),a("tr",ie,[...t[24]||(t[24]=[e("td",{colspan:"3",class:"px-4 py-6"}," Tidak ada karyawan yang cocok. ",-1)])])):h("",!0),(o(!0),a(y,null,g(V.value,s=>{var b;return o(),a("tr",{key:s.id},[e("td",ue,[e("div",pe,[e("label",ce,[e("input",{type:"checkbox",class:"mr-2",checked:l(r).user_ids.includes(s.id),onChange:P=>D(s.id,"create")},null,40,me),t[25]||(t[25]=m(" Periode ",-1))]),e("label",xe,[e("input",{type:"checkbox",class:"mr-2",checked:l(d).user_ids.includes(s.id),onChange:P=>D(s.id,"generate")},null,40,be),t[26]||(t[26]=m(" Generate ",-1))])])]),e("td",ye,[e("p",fe,n(s.name),1),e("p",ge,n(s.email),1)]),e("td",_e,n(((b=w.outlets.find(P=>P.id===s.outlet_id))==null?void 0:b.name)||"Tidak ada outlet"),1)])}),128))])])])])]),_:1}),i(k,null,{default:u(()=>[e("div",ve,[t[28]||(t[28]=e("h2",{class:"text-lg font-semibold text-text"}," Riwayat Periode ",-1)),e("div",we,[(o(!0),a(y,null,g(B.value,s=>(o(),a("div",{key:s.id,class:"p-3 bg-surface-2 rounded-lg border border-border"},[e("p",he,n(s.name),1),e("p",ke,n(new Date(s.start_date).toLocaleDateString("id-ID"))+" - "+n(new Date(s.end_date).toLocaleDateString("id-ID")),1),e("span",{class:$(["inline-flex mt-2 px-2 py-1 rounded-full text-xs",s.status==="active"?"bg-primary-100 text-primary-800":s.status==="completed"?"bg-success-100 text-success-800":"bg-gray-100 text-gray-700"])},n(s.status),3)]))),128)),B.value.length===0?(o(),a("p",Pe," Belum ada periode yang tercatat. ")):h("",!0)])])]),_:1})])])]),_:1})],64))}};export{Ue as default};
