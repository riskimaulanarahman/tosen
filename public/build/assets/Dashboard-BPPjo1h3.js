import{r as g,C as _e,c as C,a as n,d as v,o as l,e,t as r,v as ye,q as p,A as we,b as m,w as c,u as Ce,f as Me,k as U,h as o,i as Be,n as $,l as Y,F as I,j as Z}from"./app-B9127wO6.js";import{A as oe}from"./AuthenticatedLayout-BhaAR9wv.js";import{_ as w}from"./Card.vue_vue_type_script_setup_true_lang-Yr55VJw9.js";import{_ as T}from"./Button.vue_vue_type_script_setup_true_lang-B_FY260r.js";import{u as Ee,C as je}from"./attendanceState-BBniGzqD.js";import{M as Re}from"./MapModal-C-4_YE9_.js";import{_ as Oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-BmqMDh0O.js";const Ae={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},De={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Se={class:"mb-4"},Te={class:"text-lg font-bold text-gray-900"},Ge={key:0,class:"text-sm text-gray-600 mt-1"},Le={class:"mb-4"},Ue={class:"block text-sm font-medium text-gray-700 mb-2"},$e=["min","max","placeholder"],qe={class:"flex justify-between mt-1"},ze={class:"text-xs text-gray-500"},Ie={class:"text-xs text-gray-500"},Ve={class:"flex space-x-3"},He={__name:"CheckoutRemarksModal",props:{show:Boolean,validation:Object,remarks:String},emits:["close","confirm","update:remarks"],setup(k,{emit:M}){const s=k,u=M,x=g(s.remarks||"");_e(()=>s.remarks,D=>{x.value=D||""});const B=C(()=>{if(!s.validation.requiresEarlyCheckoutRemarks&&!s.validation.requiresOvertimeRemarks)return!0;const D=s.validation.requiresEarlyCheckoutRemarks?s.validation.earlyCheckoutRules.min:s.validation.overtimeRules.min,f=s.validation.requiresEarlyCheckoutRemarks?s.validation.earlyCheckoutRules.max:s.validation.overtimeRules.max;return x.value.length>=D&&x.value.length<=f}),V=C(()=>s.validation.requiresEarlyCheckoutRemarks?"âš ï¸ Early Checkout Detected":s.validation.requiresOvertimeRemarks?"â° Overtime Detected":"ðŸ“ Checkout Remarks"),E=C(()=>s.validation.requiresEarlyCheckoutRemarks?`Work duration: ${Math.floor(s.validation.workDurationMinutes/60)}h ${s.validation.workDurationMinutes%60}m (minimum: ${Math.floor(s.validation.earlyCheckoutThreshold/60)}h)`:s.validation.requiresOvertimeRemarks?`Overtime: ${Math.floor(s.validation.overtimeMinutes/60)}h ${s.validation.overtimeMinutes%60}m`:""),H=C(()=>s.validation.requiresEarlyCheckoutRemarks?"Mohon isi alasan early checkout (contoh: ada urusan penting, sakit, dll)...":s.validation.requiresOvertimeRemarks?"Mohon isi alasan overtime (contoh: project mendesak, covering rekan, dll)...":"Catatan checkout..."),j=C(()=>s.validation.requiresEarlyCheckoutRemarks?s.validation.earlyCheckoutRules:s.validation.requiresOvertimeRemarks?s.validation.overtimeRules:{min:10,max:300}),N=()=>{B.value&&u("confirm",x.value)},P=()=>{u("close")};return(D,f)=>k.show?(l(),n("div",Ae,[e("div",De,[e("div",Se,[e("h3",Te,r(V.value),1),E.value?(l(),n("p",Ge,r(E.value),1)):v("",!0)]),e("div",Le,[e("label",Ue,[p(" ðŸ“ "+r(k.validation.requiresEarlyCheckoutRemarks?"Justifikasi Early Checkout":k.validation.requiresOvertimeRemarks?"Catatan Overtime":"Catatan Checkout")+" ",1),f[1]||(f[1]=e("span",{class:"text-red-500"},"*",-1))]),ye(e("textarea",{"onUpdate:modelValue":f[0]||(f[0]=S=>x.value=S),min:j.value.min,max:j.value.max,rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:H.value},null,8,$e),[[we,x.value]]),e("div",qe,[e("span",ze," Minimum "+r(j.value.min)+" karakter ",1),e("span",Ie,r(x.value.length)+" / "+r(j.value.max),1)])]),e("div",Ve,[m(T,{onClick:P,variant:"secondary",class:"flex-1"},{default:c(()=>[...f[2]||(f[2]=[p(" Batal ",-1)])]),_:1}),m(T,{onClick:N,disabled:!B.value,variant:"primary",class:"flex-1"},{default:c(()=>[...f[3]||(f[3]=[p(" Lanjutkan Checkout ",-1)])]),_:1},8,["disabled"])])])])):v("",!0)}},Ne={key:0,class:"mb-6"},Pe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Ke={class:"flex items-center"},Fe={class:"ml-4 flex-1"},Je={class:"text-3xl font-bold text-text"},We={class:"flex items-center"},Xe={class:"ml-4 flex-1"},Qe={class:"text-3xl font-bold text-text"},Ye={class:"flex items-center"},Ze={class:"ml-4 flex-1"},et={class:"text-3xl font-bold text-text"},tt={class:"flex items-center"},st={class:"ml-4 flex-1"},at={class:"text-3xl font-bold text-text"},ot={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},lt={class:"flex items-center justify-between mb-6"},nt={key:0,class:"space-y-4"},rt={class:"font-medium text-text"},it={class:"text-sm text-muted"},ut={key:1,class:"text-center py-8 text-muted"},dt={key:0,class:"space-y-4"},ct={class:"font-medium text-text"},mt={class:"text-sm text-muted"},ht={class:"text-xs text-text-3"},vt={key:1,class:"text-center py-8 text-muted"},xt={key:0,class:"mb-6"},ft={key:1,class:"flex items-center justify-center py-12"},kt={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},pt={class:"lg:col-span-1 space-y-6"},gt={key:0,class:"space-y-3"},bt={class:"text-text font-medium"},_t={key:0},yt={class:"space-y-2"},wt={class:"flex items-center justify-between"},Ct={key:0,class:"w-2 h-2 bg-success-600 rounded-full mr-1.5 animate-pulse"},Mt={key:1,class:"w-2 h-2 bg-warning-600 rounded-full mr-1.5"},Bt={class:"flex items-center text-sm text-text-2"},Et={key:0,class:"flex items-start text-sm text-text-2"},jt={class:"line-clamp-2"},Rt={key:1},Ot={class:"space-y-1 text-sm"},At={class:"flex justify-between"},Dt={class:"text-text font-medium"},St={class:"flex justify-between"},Tt={class:"text-text font-medium"},Gt={class:"flex justify-between"},Lt={class:"text-text font-medium"},Ut={class:"flex justify-between"},$t={class:"text-text font-medium"},qt={class:"text-text font-medium"},zt={key:2},It={class:"flex flex-col gap-1"},Vt=["href"],Ht={key:1,class:"text-muted"},Nt={class:"mb-6"},Pt={key:0,class:"space-y-2"},Kt={key:0,class:"flex justify-between"},Ft={class:"text-success font-medium"},Jt={key:1,class:"flex justify-between"},Wt={class:"text-warning font-medium"},Xt={key:2,class:"text-warning text-sm"},Qt={key:1,class:"text-muted"},Yt={class:"space-y-3"},Zt={key:0},es={key:1},ts={key:2},ss={key:1,class:"text-center text-sm text-warning-600 bg-warning-50 rounded-lg p-3"},as={class:"font-medium mb-1"},os={class:"text-xs"},ls={key:0,class:"text-xs mt-1"},ns={key:0},rs={key:1},is={key:2},us={key:0},ds={key:1},cs={class:"lg:col-span-2"},ms={key:0},hs={class:"overflow-x-auto"},vs={class:"w-full border-collapse"},xs={class:"px-4 py-3 border-b border-border"},fs={class:"px-4 py-3 border-b border-border text-success"},ks={class:"px-4 py-3 border-b border-border"},ps={key:0,class:"text-warning"},gs={key:1,class:"text-muted"},bs={class:"px-4 py-3 border-b border-border"},_s={class:"px-4 py-3 border-b border-border"},ys={key:1,class:"text-center py-12 text-muted"},ws={__name:"Dashboard",props:{user:Object,userRole:String,stats:Object,recentOutlets:Array,recentAttendances:Array,today_attendance:Object,outlet:Object},setup(k){Ce();const M=k,{todayAttendance:s,outlet:u,isLoading:x,checkoutRemarks:B,canCheckIn:V,canCheckOut:E,isCheckedIn:H,checkoutValidation:j,updateAttendance:N,updateOutlet:P,resetCheckoutRemarks:D,fetchAttendanceStatus:f}=Ee(),S=g(M.recentAttendances??[]),K=g(!0),_=g(""),A=g(""),G=g(!1),R=g(""),ee=g(null),q=g(!1),F=g(!1),J=g(null),z=g(!1),le=a=>{J.value=a,F.value=!0},ne=()=>{F.value=!1,J.value=null},re=a=>!a.latitude||!a.longitude?"#":`https://www.google.com/maps?q=${a.latitude},${a.longitude}`,ie=()=>new Promise((a,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by this browser."));return}navigator.geolocation.getCurrentPosition(i=>{a({latitude:i.coords.latitude,longitude:i.coords.longitude,accuracy:i.coords.accuracy})},i=>{t(i)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),W=(a,t=null)=>{console.error("Error:",a),_.value=(a==null?void 0:a.message)||t||"Terjadi kesalahan. Silakan coba lagi.",A.value="error"},ue=a=>{_.value=a,A.value="success",setTimeout(()=>{_.value="",A.value=""},5e3)},de=()=>{R.value="checkin",G.value=!0},ce=()=>{j.value.requiresEarlyCheckoutRemarks||j.value.requiresOvertimeRemarks?z.value=!0:te()},te=()=>{R.value="checkout",G.value=!0,z.value=!1},me=a=>{B.value=a,te()},he=()=>{z.value=!1},ve=async a=>{var i,d;if(q.value)return;if(q.value=!0,_.value="",!R.value){W("Aksi belum dipilih. Klik tombol CHECK IN atau CHECK OUT terlebih dahulu."),q.value=!1;return}const t=R.value;try{if(!a)throw new Error("Selfie tidak tersedia. Ulangi pengambilan foto.");const h=new FormData;h.append("selfie",a,`selfie_${Date.now()}.jpg`);const y=await ie();h.append("latitude",y.latitude),h.append("longitude",y.longitude),y.accuracy!==void 0&&h.append("accuracy",y.accuracy),t==="checkout"&&B.value&&h.append("checkout_remarks",B.value);const be=t==="checkin"?"attendance.checkin":"attendance.checkout",Q=await fetch(route(be),{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:h});let b={};try{b=await Q.json()}catch(O){console.error("Failed to parse response:",O)}if(Q.ok){let O="";t==="checkin"?O=`Berhasil check-in di ${b.outlet_name}! Jarak: ${b.distance}m`:O=`Berhasil check-out! Durasi kerja: ${((i=b.work_duration)==null?void 0:i.formatted)||"N/A"} jam`,ue(O),G.value=!1,R.value="",ee.value=null,t==="checkout"&&D(),await f()}else{if(b.errors&&b.errors.checkout_remarks)throw new Error(b.errors.checkout_remarks[0]);const O=new Error((b==null?void 0:b.message)||"Terjadi kesalahan pada server.");throw O.response={status:Q.status,data:b},O}}catch(h){const y=((d=h==null?void 0:h.message)==null?void 0:d.toLowerCase())||"";y.includes("lokasi")||y.includes("location")?W(h,"Tidak bisa mendapatkan lokasi Anda. Silakan aktifkan layanan lokasi."):W(h)}finally{q.value=!1}},xe=async a=>{console.log("Camera confirm received:",a),await ve(a)},fe=()=>{G.value=!1,R.value="",ee.value=null},ke=async()=>{var a,t;try{console.log("DEBUG: Refreshing attendance status..."),await f(),console.log("DEBUG: Today attendance set to:",s.value),console.log("DEBUG: Today attendance check_out_time:",(a=s.value)==null?void 0:a.check_out_time),console.log("DEBUG: Today attendance status:",(t=s.value)==null?void 0:t.status),console.log("DEBUG: Can check out computed:",E.value),console.log("DEBUG: Should show checkout button:",ae.value)}catch(i){console.error("Error refreshing attendance status:",i),_.value="Gagal memuat data absensi. Silakan refresh halaman.",A.value="error"}},L=a=>a?new Date(a).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):"-",se=a=>a?new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",pe=a=>{switch(a){case"checked_in":return"bg-success-100 text-success";case"checked_out":return"bg-info-100 text-info";default:return"bg-surface-2 text-text-3"}},ge=a=>{switch(a){case"checked_in":return"Sedang Check-in";case"checked_out":return"Sudah Check-out";default:return"Belum lakukan absensi"}};C(()=>!s.value||!s.value.status?"Belum melakukan absensi hari ini":ge(s.value.status)),C(()=>!s.value||!s.value.status?"bg-surface-2 text-text-3":pe(s.value.status));const X=C(()=>{var a,t;return(!s.value||s.value.check_out_time)&&((t=(a=u.value)==null?void 0:a.operational_status)==null?void 0:t.status)==="open"}),ae=C(()=>{var a,t;return console.log("DEBUG: shouldShowCheckoutButton called"),console.log("DEBUG: todayAttendance.value:",s.value),console.log("DEBUG: check_out_time:",(a=s.value)==null?void 0:a.check_out_time),console.log("DEBUG: status:",(t=s.value)==null?void 0:t.status),E.value});return Me(async()=>{console.log("DEBUG: Dashboard onMounted called"),console.log("DEBUG: Initial props:",{today_attendance:M.today_attendance,outlet:M.outlet,userRole:M.userRole}),console.log("DEBUG: isInitialLoading initial value:",K.value);try{console.log("DEBUG: Updating attendance with props"),N(M.today_attendance),console.log("DEBUG: Updating outlet with props"),P(M.outlet),console.log("DEBUG: About to fetch attendance status"),await f(),console.log("DEBUG: Attendance status fetched successfully"),console.log("DEBUG: Final state after initialization:",{todayAttendance:s.value,outlet:u.value,canCheckIn:V.value,canCheckOut:E.value,isCheckedIn:H.value,isLoading:x.value})}catch(a){console.error("Error initializing dashboard:",a),console.error("DEBUG: Error details:",{message:a.message,stack:a.stack,name:a.name}),_.value="Gagal memuat data absensi. Silakan refresh halaman.",A.value="error"}finally{console.log("DEBUG: Setting isInitialLoading to false"),K.value=!1}}),(a,t)=>(l(),n(I,null,[m(o(Be),{title:"Dashboard"}),k.userRole==="owner"?(l(),U(oe,{key:0},{default:c(()=>[_.value?(l(),n("div",Ne,[e("div",{class:$(["px-4 py-3 rounded-lg text-sm",A.value==="success"?"bg-success-50 border border-success text-success-600":"bg-error-50 border border-error text-error-600"])},r(_.value),3)])):v("",!0),e("div",Pe,[m(w,{class:"group"},{default:c(()=>{var i;return[e("div",Ke,[t[4]||(t[4]=e("div",{class:"relative"},[e("div",{class:"w-14 h-14 bg-orange-500 rounded-lg flex items-center justify-center shadow-lg shadow-orange-500/25 group-hover:shadow-xl transition-all duration-200 transform group-hover:scale-110"},[e("svg",{class:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])]),e("div",{class:"absolute inset-0 bg-orange-500/30 rounded-lg blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200"})],-1)),e("div",Fe,[t[2]||(t[2]=e("p",{class:"text-muted text-sm font-medium mb-1"}," Total Outlet ",-1)),e("p",Je,r(((i=k.stats)==null?void 0:i.totalOutlets)||0),1),t[3]||(t[3]=e("div",{class:"flex items-center mt-2"},[e("div",{class:"flex items-center text-success text-xs font-medium"},[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L6.707 7.707a1 1 0 01-1.414 0z","clip-rule":"evenodd"})]),p(" 12% ")]),e("span",{class:"text-text-3 text-xs ml-2"},"dari bulan lalu")],-1))])])]}),_:1}),m(w,{class:"group"},{default:c(()=>{var i;return[e("div",We,[t[7]||(t[7]=e("div",{class:"relative"},[e("div",{class:"w-14 h-14 bg-green-500 rounded-lg flex items-center justify-center shadow-lg shadow-green-500/25 group-hover:shadow-xl transition-all duration-200 transform group-hover:scale-110"},[e("svg",{class:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})])]),e("div",{class:"absolute inset-0 bg-green-500/30 rounded-lg blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200"})],-1)),e("div",Xe,[t[5]||(t[5]=e("p",{class:"text-muted text-sm font-medium mb-1"}," Total Karyawan ",-1)),e("p",Qe,r(((i=k.stats)==null?void 0:i.totalEmployees)||0),1),t[6]||(t[6]=e("div",{class:"flex items-center mt-2"},[e("div",{class:"flex items-center text-success text-xs font-medium"},[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L6.707 7.707a1 1 0 01-1.414 0z","clip-rule":"evenodd"})]),p(" 8% ")]),e("span",{class:"text-text-3 text-xs ml-2"},"dari bulan lalu")],-1))])])]}),_:1}),m(w,{class:"group"},{default:c(()=>{var i;return[e("div",Ye,[t[10]||(t[10]=e("div",{class:"relative"},[e("div",{class:"w-14 h-14 bg-blue-500 rounded-lg flex items-center justify-center shadow-lg shadow-blue-500/25 group-hover:shadow-xl transition-all duration-200 transform group-hover:scale-110"},[e("svg",{class:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])]),e("div",{class:"absolute inset-0 bg-blue-500/30 rounded-lg blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200"})],-1)),e("div",Ze,[t[8]||(t[8]=e("p",{class:"text-muted text-sm font-medium mb-1"}," Total Absensi ",-1)),e("p",et,r(((i=k.stats)==null?void 0:i.totalAttendances)||0),1),t[9]||(t[9]=e("div",{class:"flex items-center mt-2"},[e("div",{class:"flex items-center text-warning text-xs font-medium"},[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z","clip-rule":"evenodd"})]),p(" 3% ")]),e("span",{class:"text-text-3 text-xs ml-2"},"dari bulan lalu")],-1))])])]}),_:1}),m(w,{class:"group"},{default:c(()=>{var i;return[e("div",tt,[t[13]||(t[13]=e("div",{class:"relative"},[e("div",{class:"w-14 h-14 bg-yellow-500 rounded-lg flex items-center justify-center shadow-lg shadow-yellow-500/25 group-hover:shadow-xl transition-all duration-200 transform group-hover:scale-110"},[e("svg",{class:"w-7 h-7 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])]),e("div",{class:"absolute inset-0 bg-yellow-500/30 rounded-lg blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200"})],-1)),e("div",st,[t[11]||(t[11]=e("p",{class:"text-muted text-sm font-medium mb-1"}," Check-in Hari Ini ",-1)),e("p",at,r(((i=k.stats)==null?void 0:i.todayAttendances)||0),1),t[12]||(t[12]=e("div",{class:"flex items-center mt-2"},[e("div",{class:"flex items-center text-success text-xs font-medium"},[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M5.293 7.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L6.707 7.707a1 1 0 01-1.414 0z","clip-rule":"evenodd"})]),p(" 15% ")]),e("span",{class:"text-text-3 text-xs ml-2"},"dari kemarin")],-1))])])]}),_:1})]),e("div",ot,[m(w,null,{default:c(()=>{var i;return[e("div",lt,[t[15]||(t[15]=e("h2",{class:"text-lg font-bold text-text"},"Outlet Terbaru",-1)),m(o(Y),{href:a.route("outlets.index"),class:"text-primary hover:text-primary-400 text-sm font-medium"},{default:c(()=>[...t[14]||(t[14]=[p(" Lihat Semua ",-1)])]),_:1},8,["href"])]),((i=k.recentOutlets)==null?void 0:i.length)>0?(l(),n("div",nt,[(l(!0),n(I,null,Z(k.recentOutlets,d=>{var h;return l(),n("div",{key:d.id,class:"flex items-center justify-between p-3 bg-surface-2 rounded-none"},[e("div",null,[e("p",rt,r(d.name),1),e("p",it,r(((h=d.employees)==null?void 0:h.length)||0)+" karyawan ",1)]),m(o(Y),{href:a.route("outlets.show",d.id),class:"text-primary hover:text-primary-400"},{default:c(()=>[...t[16]||(t[16]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),_:1},8,["href"])])}),128))])):(l(),n("div",ut,[t[18]||(t[18]=e("p",null,"Belum ada outlet. Buat outlet pertama Anda!",-1)),m(o(Y),{href:a.route("outlets.create"),class:"mt-4 inline-block"},{default:c(()=>[m(T,{variant:"primary",size:"sm"},{default:c(()=>[...t[17]||(t[17]=[p(" Buat Outlet ",-1)])]),_:1})]),_:1},8,["href"])]))]}),_:1}),m(w,null,{default:c(()=>{var i;return[t[20]||(t[20]=e("h2",{class:"text-lg font-bold text-text mb-6"}," Absensi Terbaru ",-1)),((i=S.value)==null?void 0:i.length)>0?(l(),n("div",dt,[(l(!0),n(I,null,Z(S.value,d=>{var h,y;return l(),n("div",{key:d.id,class:"flex items-center justify-between p-3 bg-surface-2 rounded-none"},[e("div",null,[e("p",ct,r((h=d.user)==null?void 0:h.name),1),e("p",mt,r((y=d.outlet)==null?void 0:y.name),1),e("p",ht,r(d.check_in_time?L(d.check_in_time):"-")+" - "+r(se(d.created_at)),1)]),e("div",null,[e("span",{class:$(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",d.status==="checked_in"?"bg-success-100 text-success-600":"bg-surface-3 text-text-2"])},r(d.status==="checked_in"?"Check-in":"Selesai"),3)])])}),128))])):(l(),n("div",vt,[...t[19]||(t[19]=[e("p",null,"Belum ada data absensi.",-1)])]))]}),_:1})])]),_:1})):(l(),U(oe,{key:1},{default:c(()=>[_.value?(l(),n("div",xt,[e("div",{class:$(["px-4 py-3 rounded-lg text-sm",A.value==="success"?"bg-success-100 border border-success text-success-600":"bg-error-100 border border-error text-error-600"])},r(_.value),3)])):v("",!0),K.value?(l(),n("div",ft,[...t[21]||(t[21]=[e("div",{class:"text-center"},[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e("p",{class:"mt-4 text-muted"},"Memuat data absensi...")],-1)])])):(l(),n("div",kt,[e("div",pt,[m(w,null,{default:c(()=>[t[35]||(t[35]=e("h2",{class:"text-xl font-bold text-text mb-4"}," Informasi Outlet ",-1)),o(u)?(l(),n("div",gt,[e("div",null,[t[22]||(t[22]=e("div",{class:"text-sm text-muted"},"Nama Outlet",-1)),e("div",bt,r(o(u).name),1)]),o(u).operational_status?(l(),n("div",_t,[t[25]||(t[25]=e("div",{class:"text-sm text-muted mb-2"}," Jam Operasional ",-1)),e("div",yt,[e("div",wt,[e("span",{class:$(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",o(u).operational_status.status==="open"?"bg-success-100 text-success-600":"bg-warning-100 text-warning-600"])},[o(u).operational_status.status==="open"?(l(),n("span",Ct)):(l(),n("span",Mt)),p(" "+r(o(u).operational_status.text),1)],2)]),e("div",Bt,[t[23]||(t[23]=e("svg",{class:"w-4 h-4 mr-1.5 text-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),p(" "+r(o(u).operational_status.time),1)]),o(u).work_days&&o(u).work_days.length>0?(l(),n("div",Et,[t[24]||(t[24]=e("svg",{class:"w-4 h-4 mr-1.5 text-muted mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("span",jt,r(o(u).formatted_work_days),1)])):v("",!0)])])):v("",!0),o(u).tolerance_settings?(l(),n("div",Rt,[t[30]||(t[30]=e("div",{class:"text-sm text-muted mb-2"}," Pengaturan Toleransi ",-1)),e("div",Ot,[e("div",At,[t[26]||(t[26]=e("span",{class:"text-text-2"},"Grace Period:",-1)),e("span",Dt,r(o(u).tolerance_settings.grace_period)+" menit ",1)]),e("div",St,[t[27]||(t[27]=e("span",{class:"text-text-2"},"Toleransi Keterlambatan:",-1)),e("span",Tt,r(o(u).tolerance_settings.late_tolerance)+" menit ",1)]),e("div",Gt,[t[28]||(t[28]=e("span",{class:"text-text-2"},"Toleransi Checkout Awal:",-1)),e("span",Lt,r(o(u).tolerance_settings.early_checkout_tolerance)+" menit ",1)]),e("div",Ut,[t[29]||(t[29]=e("span",{class:"text-text-2"},"Batas Overtime:",-1)),e("span",$t,r(o(u).tolerance_settings.overtime_threshold)+" menit ",1)])])])):v("",!0),e("div",null,[t[31]||(t[31]=e("div",{class:"text-sm text-muted"}," Radius Geofence ",-1)),e("div",qt,r(o(u).radius)+" meter ",1)]),o(u).latitude&&o(u).longitude?(l(),n("div",zt,[t[34]||(t[34]=e("div",{class:"text-sm text-muted mb-2"}," Lokasi & Peta ",-1)),e("div",It,[e("button",{onClick:t[0]||(t[0]=i=>le(o(u))),class:"inline-flex items-center px-3 py-2 text-xs text-primary hover:text-primary-400 transition-colors bg-surface-2 hover:bg-surface-3 rounded-none",title:"Lihat peta"},[...t[32]||(t[32]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1),p(" Lihat Peta ",-1)])]),e("a",{href:re(o(u)),target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center px-3 py-2 text-xs text-blue-600 hover:text-blue-700 transition-colors bg-surface-2 hover:bg-surface-3 rounded-none",title:"Buka di Google Maps"},[...t[33]||(t[33]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1),p(" Google Maps ",-1)])],8,Vt)])])):v("",!0)])):(l(),n("div",Ht," Anda tidak terassign ke outlet mana pun. "))]),_:1}),o(u)?(l(),U(w,{key:0},{default:c(()=>{var i;return[t[39]||(t[39]=e("h2",{class:"text-xl font-bold text-text mb-4"}," Aksi Absensi ",-1)),e("div",Nt,[t[38]||(t[38]=e("div",{class:"text-sm text-muted mb-2"}," Status Hari Ini ",-1)),o(s)?(l(),n("div",Pt,[o(s).check_in_time?(l(),n("div",Kt,[t[36]||(t[36]=e("span",{class:"text-text"},"Check-in:",-1)),e("span",Ft,r(L(o(s).check_in_time)),1)])):v("",!0),o(s).check_out_time?(l(),n("div",Jt,[t[37]||(t[37]=e("span",{class:"text-text"},"Check-out:",-1)),e("span",Wt,r(L(o(s).check_out_time)),1)])):v("",!0),o(s).check_out_time?v("",!0):(l(),n("div",Xt," Sedang check-in "))])):(l(),n("div",Qt," Belum ada absensi hari ini "))]),e("div",Yt,[!o(s)||o(s).check_out_time?(l(),U(T,{key:0,onClick:de,disabled:o(x)||!X.value,variant:"primary",size:"lg",class:"w-full"},{default:c(()=>[o(x)?(l(),n("span",Zt,"Sedang Check-in...")):X.value?(l(),n("span",ts,"ðŸ“ CHECK IN")):(l(),n("span",es," ðŸ”’ Outlet Tutup "))]),_:1},8,["disabled"])):v("",!0),(!o(s)||o(s).check_out_time)&&!X.value&&((i=o(u))!=null&&i.operational_status)?(l(),n("div",ss,[e("div",as,r(o(u).operational_status.text),1),e("div",os,r(o(u).operational_status.time),1),o(u).operational_status.time_until_next?(l(),n("div",ls,r(o(u).operational_status.time_until_next),1)):v("",!0)])):v("",!0),ae.value?(l(),U(T,{key:2,onClick:ce,disabled:o(x)||!o(E),variant:"danger",size:"lg",class:"w-full"},{default:c(()=>[o(x)?(l(),n("span",ns,"Sedang Check-out...")):o(E)?(l(),n("span",is,"ðŸ“ CHECK OUT")):(l(),n("span",rs," ðŸ”’ Check-in Dulu "))]),_:1},8,["disabled"])):v("",!0),m(T,{onClick:ke,disabled:o(x),variant:"secondary",size:"sm",class:"w-full mt-3"},{default:c(()=>[o(x)?(l(),n("span",us,"ðŸ”„ Refreshing...")):(l(),n("span",ds,"ðŸ”„ Refresh Data"))]),_:1},8,["disabled"])])]}),_:1})):v("",!0)]),e("div",cs,[m(w,null,{default:c(()=>{var i;return[t[42]||(t[42]=e("h2",{class:"text-xl font-bold text-text mb-6"}," Riwayat Absensi Terbaru ",-1)),((i=S.value)==null?void 0:i.length)>0?(l(),n("div",ms,[e("div",hs,[e("table",vs,[t[40]||(t[40]=e("thead",{class:"bg-surface-2 text-text-2 font-semibold"},[e("tr",null,[e("th",{class:"px-4 py-3 border-b border-border text-left"}," Tanggal "),e("th",{class:"px-4 py-3 border-b border-border text-left"}," Check In "),e("th",{class:"px-4 py-3 border-b border-border text-left"}," Check Out "),e("th",{class:"px-4 py-3 border-b border-border text-left"}," Jarak "),e("th",{class:"px-4 py-3 border-b border-border text-left"}," Status ")])],-1)),e("tbody",null,[(l(!0),n(I,null,Z(S.value,d=>(l(),n("tr",{key:d.id,class:"hover:bg-surface-2"},[e("td",xs,r(se(d.created_at)),1),e("td",fs,r(L(d.check_in_time)),1),e("td",ks,[d.check_out_time?(l(),n("span",ps,r(L(d.check_out_time)),1)):(l(),n("span",gs,"-"))]),e("td",bs,r(d.check_in_distance?Math.round(d.check_in_distance)+"m":"-"),1),e("td",_s,[e("span",{class:$(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",d.status==="checked_in"?"bg-success-100 text-success-600":"bg-surface-3 text-text-2"])},r(d.status==="checked_in"?"Check-in":"Selesai"),3)])]))),128))])])])])):(l(),n("div",ys,[...t[41]||(t[41]=[e("p",null,"Belum ada data absensi.",-1)])]))]}),_:1})])])),m(He,{show:z.value,validation:o(j),remarks:o(B),onClose:he,onConfirm:me,"onUpdate:remarks":t[1]||(t[1]=i=>B.value=i)},null,8,["show","validation","remarks"]),m(je,{show:G.value,title:R.value==="checkin"?"ðŸ“¸ Check-in dengan Selfie":"ðŸ“¸ Check-out dengan Selfie",subtitle:R.value==="checkin"?"Posisikan wajah Anda di dalam frame":"Ambil foto selfie untuk check-out",onConfirm:xe,onClose:fe},null,8,["show","title","subtitle"]),m(Re,{show:F.value,outlet:J.value,onClose:ne},null,8,["show","outlet"])]),_:1}))],64))}},Ds=Oe(ws,[["__scopeId","data-v-6bb6d6d5"]]);export{Ds as default};
