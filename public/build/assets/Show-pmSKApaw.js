import{c as g,m as D,a as i,b as o,h as d,i as B,w as r,e as t,t as s,l as A,q as _,v as I,d as S,A as K,o as n,F as P,j as C,n as $}from"./app-CKTrW43v.js";import{A as E}from"./AuthenticatedLayout-CDs14gSP.js";import{_ as x}from"./Card.vue_vue_type_script_setup_true_lang-CwzmMHeM.js";import{_ as f}from"./Button.vue_vue_type_script_setup_true_lang-DINjassF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"space-y-6"},M={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},O={class:"text-2xl font-bold text-text",style:{"font-family":"'Oswald', sans-serif"}},q={class:"text-muted"},R={class:"flex flex-wrap gap-2"},z={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},G={class:"p-4"},U={class:"text-3xl font-bold text-text"},H={class:"p-4"},J={class:"text-3xl font-bold text-success"},Q={class:"p-4"},W={class:"text-3xl font-bold text-info"},X={class:"p-6 space-y-4"},Y={key:0,class:"text-xs text-danger"},Z={class:"p-6 space-y-4"},tt={class:"overflow-x-auto"},et={class:"min-w-full divide-y divide-border text-sm"},st={class:"divide-y divide-border"},at={key:0},lt={class:"px-4 py-3"},ot={class:"font-semibold text-text"},rt={class:"text-xs text-muted"},dt={class:"px-4 py-3"},it={class:"text-xs text-muted"},nt={class:"px-4 py-3"},ut={class:"px-4 py-3"},pt={class:"px-4 py-3"},ct={key:0,class:"text-xs text-muted"},xt={key:1,class:"text-xs text-muted space-y-1"},vt={__name:"Show",props:{payrollPeriod:{type:Object,required:!0}},setup(p){const m=p,y=g(()=>{var l;return((l=m.payrollPeriod)==null?void 0:l.payroll_records)||[]}),u=D({notes:""}),h=D({}),c=l=>l==null?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(Number(l)),v=l=>l?new Date(l).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-",N=g(()=>y.value.reduce((l,e)=>l+Number(e.total_pay||0)-Number(e.tax_deduction||0)-Number(e.other_deductions||0),0)),j=g(()=>y.value.length),F=()=>{u.post(route("payroll.approve",m.payrollPeriod.id),{preserveScroll:!0,onSuccess:()=>u.reset()})},T=()=>{h.post(route("payroll.process.payments",m.payrollPeriod.id),{preserveScroll:!0})},V=()=>{window.location.href=route("payroll.export",m.payrollPeriod.id)};return(l,e)=>(n(),i(P,null,[o(d(B),{title:`Detail Payroll: ${p.payrollPeriod.name}`},null,8,["title"]),o(E,null,{default:r(()=>[t("div",L,[t("div",M,[t("div",null,[t("h1",O,s(p.payrollPeriod.name),1),t("p",q," Periode "+s(v(p.payrollPeriod.start_date))+" - "+s(v(p.payrollPeriod.end_date)),1)]),t("div",R,[o(d(A),{href:l.route("payroll.index")},{default:r(()=>[o(f,{variant:"secondary"},{default:r(()=>[...e[1]||(e[1]=[_("Kembali",-1)])]),_:1})]),_:1},8,["href"]),o(f,{variant:"ghost",onClick:V},{default:r(()=>[...e[2]||(e[2]=[_("Export CSV",-1)])]),_:1}),o(f,{variant:"primary",disabled:d(u).processing,onClick:F},{default:r(()=>[_(s(d(u).processing?"Menyetujui...":"Setujui Periode"),1)]),_:1},8,["disabled"]),o(f,{variant:"success",disabled:d(h).processing||p.payrollPeriod.status!=="completed",onClick:T},{default:r(()=>[_(s(d(h).processing?"Memproses...":"Proses Pembayaran"),1)]),_:1},8,["disabled"])])]),t("div",z,[o(x,null,{default:r(()=>[t("div",G,[e[3]||(e[3]=t("p",{class:"text-sm text-muted"},"Total Karyawan",-1)),t("p",U,s(j.value),1)])]),_:1}),o(x,null,{default:r(()=>[t("div",H,[e[4]||(e[4]=t("p",{class:"text-sm text-muted"},"Total Gaji Bersih",-1)),t("p",J,s(c(N.value)),1)])]),_:1}),o(x,null,{default:r(()=>[t("div",Q,[e[5]||(e[5]=t("p",{class:"text-sm text-muted"},"Status Periode",-1)),t("p",W,s(p.payrollPeriod.status),1)])]),_:1})]),o(x,null,{default:r(()=>[t("div",X,[e[6]||(e[6]=t("h2",{class:"text-lg font-semibold text-text"},"Catatan Persetujuan",-1)),I(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=a=>d(u).notes=a),rows:"3",class:"w-full px-3 py-2 bg-surface-2 border border-border rounded-lg",placeholder:"Catatan untuk approval..."},null,512),[[K,d(u).notes]]),d(u).errors.notes?(n(),i("div",Y,s(d(u).errors.notes),1)):S("",!0)])]),_:1}),o(x,null,{default:r(()=>[t("div",Z,[e[9]||(e[9]=t("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between gap-2"},[t("div",null,[t("h2",{class:"text-lg font-semibold text-text"},"Daftar Payroll"),t("p",{class:"text-sm text-muted"},"Semua karyawan pada periode ini")])],-1)),t("div",tt,[t("table",et,[e[8]||(e[8]=t("thead",null,[t("tr",{class:"text-left text-xs uppercase text-muted"},[t("th",{class:"px-4 py-3"},"Karyawan"),t("th",{class:"px-4 py-3"},"Total"),t("th",{class:"px-4 py-3"},"Status"),t("th",{class:"px-4 py-3"},"Diterima"),t("th",{class:"px-4 py-3"},"Overtime")])],-1)),t("tbody",st,[y.value.length===0?(n(),i("tr",at,[...e[7]||(e[7]=[t("td",{colspan:"5",class:"px-4 py-6 text-center text-muted"}," Belum ada payroll yang dihasilkan. ",-1)])])):S("",!0),(n(!0),i(P,null,C(y.value,a=>{var w,k;return n(),i("tr",{key:a.id},[t("td",lt,[t("p",ot,s(((w=a.user)==null?void 0:w.name)||`Karyawan #${a.user_id}`),1),t("p",rt,s(((k=a.user)==null?void 0:k.email)||"-"),1)]),t("td",dt,[t("p",null,s(c(a.total_pay)),1),t("p",it," Pajak: "+s(c(a.tax_deduction))+" â€¢ Potongan lain: "+s(c(a.other_deductions)),1)]),t("td",nt,[t("span",{class:$(["inline-flex px-2 py-1 rounded-full text-xs",a.status==="paid"?"bg-success-100 text-success-800":a.status==="approved"?"bg-primary-100 text-primary-800":"bg-gray-100 text-gray-600"])},s(a.status),3)]),t("td",ut,s(c(a.total_pay-a.tax_deduction-a.other_deductions)),1),t("td",pt,[(a.overtime_records||[]).length===0?(n(),i("div",ct," Tidak ada lembur ")):(n(),i("ul",xt,[(n(!0),i(P,null,C(a.overtime_records,b=>(n(),i("li",{key:b.id},s(v(b.date))+" â€¢ "+s(b.overtime_minutes)+" menit ",1))),128))]))])])}),128))])])])])]),_:1})])]),_:1})],64))}};export{vt as default};
